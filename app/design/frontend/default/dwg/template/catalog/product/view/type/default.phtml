<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2010 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php /* @var $this Mage_Catalog_Block_Product_View_Abstract */?>
<?php $_product = $this->getProduct() ?>
<?php 
$availableText = "<i>Experiences Available</i>";
$cartLabel = "Add to Cart";
$ticketType = "";
$remainingText = "";
$showRemaining = false;
$attributeValue = Mage::getModel('catalog/product')->load($_product->getId())->getTickettype();
$write = Mage::getSingleton('core/resource')->getConnection('core_write');
$readresult=$write->query("SELECT eav_attribute_option_value.option_id, eav_attribute_option_value.value FROM eav_attribute_option_value WHERE eav_attribute_option_value.option_id=".$attributeValue." Limit 1");
while ($row = $readresult->fetch() ) {
       $ticketType = "{$row['value']}";
}
switch($ticketType):
   case 'Ticket':
      $cartLabel = "Add to Cart";
      $remainingText = "Packages Remaining: " .(int) Mage::getModel('cataloginventory/stock_item')->loadByProduct($_product)->getQty();
      break;
   case 'Register-Package':
      $availableText = "Experiences Available";
      break;
   case 'Register-Venue':
      $availableText = "Reservations Available";
      break;
   case 'Information':
      $availableText = "";
      break;
   case 'Product-Purchase':
      $availableText = "Items in Stock: " . (int) Mage::getModel('cataloginventory/stock_item')->loadByProduct($_product)->getQty();
      $showRemaining = true;
      break;
   default:
      $availabeText = "";
endswitch;
?>
<?php if ($_product->isAvailable()): ?><?php //echo $this->__('Availability: ')  class="availability in-stock" class="availability in-stock" style="float:right;"?>
    <h2><?php echo $this->__($availableText); ?> <?php echo "&nbsp;" . $remainingText; ?></h2>
<?php else: //<p class="availability out-of-stock">?>
    <h2><?php echo $this->__('Availability:') ?><?php if($showRemaining == true) { echo $this->__('Experience Sold Out'); } else { echo $this->__('No Reservations Available');} ?></h2>
<?php endif; ?>
<?php echo $this->getChildHtml('product_type_data_extra') ?>
<?php ($showRemaining==false) ? print "<div style='display:none;'>".$this->getPriceHtml($_product)."</div>" : print $this->getPriceHtml($_product)  ?>